/* Layout Components */
@layer components {
  /* App Layout - persistent sidebar with main content */
  .app-layout {
    @apply flex flex-row w-screen h-screen overflow-hidden;
  }

  /* Sidebar */
  .sidebar {
    @apply flex flex-col h-full bg-base-200 relative flex-shrink-0;
    /* Allow tooltip overflow to show outside sidebar bounds */
    overflow: visible;
  }

  /* Only animate width when collapsing/expanding, not during drag resize */
  /* TODO: Change back to 0.2s after debugging */
  .sidebar:not(.resizing) {
    transition: width 0.2s ease-in-out;
  }

  /* Collapse Toggle Button */
  .collapse-toggle-btn {
    @apply btn btn-ghost btn-xs absolute -right-3 top-4 z-50;
    @apply rounded-full bg-base-100 border border-base-300 shadow-sm;
    @apply flex items-center justify-center;
    width: 1.5rem;
    height: 1.5rem;
    padding: 0;
  }

  .collapse-toggle-btn:hover {
    @apply bg-base-200 border-base-content/20;
  }

  /* Resize Handle */
  .resize-handle {
    @apply absolute top-0 -right-1 h-full w-2 cursor-col-resize z-40;
    @apply hover:bg-primary/20;
    transition: background-color 0.15s ease;
  }

  .resize-handle:active {
    @apply bg-primary/30;
  }

  /* Sidebar Menu */
  .sidebar-menu {
    @apply menu menu-vertical flex-grow overflow-y-auto p-2 w-full gap-0;
    /* Allow tooltips to extend outside the menu bounds */
    overflow-x: visible;
  }

  .sidebar-menu::-webkit-scrollbar {
    display: none;
  }

  /* Collapsed menu: positioned absolutely, fades in after width transition */
  .sidebar-menu-collapsed {
    @apply absolute inset-0 items-center px-1;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.1s ease-in-out 0s;
  }

  /* When sidebar is collapsed, show collapsed menu after delay */
  .sidebar.collapsed .sidebar-menu-collapsed {
    opacity: 1;
    pointer-events: auto;
    transition: opacity 0.1s ease-in-out 0.1s;
  }

  /* Expanded inner: normal flexbox positioning when stable */
  .sidebar-inner-expanded {
    @apply relative;
    opacity: 1;
    transition: opacity 0.1s ease-in-out 0s;
  }

  /* When sidebar is collapsed, hide expanded content after delay */
  .sidebar.collapsed .sidebar-inner-expanded {
    @apply absolute inset-0;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.1s ease-in-out 0.1s;
  }

  /* Inner container: fixed width prevents text reflow during expand animation */
  .sidebar-inner {
    @apply h-full overflow-hidden flex flex-col;
  }

  /* Menu Items - ensure full width */
  .sidebar-menu > li {
    @apply w-full;
  }

  .sidebar-menu li > a {
    @apply flex items-center gap-2 w-full;
  }

  .sidebar-menu.collapsed li > a {
    @apply justify-center p-2 w-auto;
  }

  /* Icon sizing within menu items */
  .sidebar-menu li > a > svg {
    @apply h-4 w-4 flex-shrink-0;
  }

  /* Accordion in sidebar */
  .sidebar-menu .accordion-item {
    @apply w-full;
  }

  .sidebar-menu .accordion-item .collapse-content {
    @apply w-full;
  }

  .sidebar-menu .accordion-item .collapse-content li {
    @apply w-full;
  }

  .sidebar-menu .accordion {
    @apply flex flex-col;
  }

  /* Category Header (Collapsed State) */
  .category-header {
    @apply flex items-center gap-2 cursor-pointer p-2;
  }

  .category-header.collapsed {
    @apply justify-center;
  }

  .category-header .icon {
    @apply h-4 w-4;
  }

  .category-header.collapsed .icon {
    @apply h-5 w-5;
  }

  /* Accordion category header with icon */
  .accordion-item .collapse-title {
    @apply flex items-center gap-2;
  }

  .accordion-item .collapse-title .icon {
    @apply h-4 w-4 flex-shrink-0;
  }

  /* Main Content Area */
  .main-content {
    @apply flex flex-col flex-grow h-full overflow-hidden;
    /* Higher z-index so content covers sidebar during expand/collapse transition */
    @apply relative z-10 bg-base-100;
  }

  /* Content Header */
  .content-header {
    @apply flex-shrink-0 px-4 py-2 bg-base-100 border-b border-base-300;
    @apply relative z-10;
  }

  .content-title {
    @apply text-xl font-semibold m-0;
  }

  /* Content Body */
  .content-body {
    @apply flex-grow overflow-y-auto overflow-x-hidden p-4 bg-base-100;
  }

  .content-body::-webkit-scrollbar {
    display: none;
  }

  /* Widget View */
  .widget-view {
    @apply w-full h-full;
  }

  .widget-view > div {
    @apply pb-3;
  }
}
